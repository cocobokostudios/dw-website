<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/_app.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/blog/%5Bid%5D.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/chunks/framework.e84fa698c7ee940652bd.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/chunks/commons.7c101d7f1672b68d7c1c.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/runtime/main-98aa3916935decc0cde3.js" as="script"/></head><body><div id="__next"><h1>Running Tomcat Apps on Docker through Eclipse</h1><article><div>running-tomcat-apps-on-docker-through-eclipse</div><div>Fri Aug 07 2015 07:55:40 GMT-0500 (Central Daylight Time)</div><div><p>If you didn't already know, <a href="https://www.docker.com">Docker</a> is pretty cool. Not sure what it is? My fellow Western Dev <a href="http://www.westerndevs.com/docker-is-coming-whether-you-like-it-or-not/">Kyle Baley</a> explains it really well and provides some great cases about why Docker is fantastic.</p>
<p>This post is an example of Docker being fantastic and should be considered a warm-up to Docker.</p>
<!--more-->
<p>Although I'm talking Tomcat and Eclipse, this idea can be used with pretty much any combination of technologies available through Docker and your development environment of choice.</p>
<h2>Context</h2>
<p>When I dive into the code, I don't want to have to worry about running some version of Tomcat on my development machine.</p>
<p>Docker can solve that.</p>
<p>I also don't like obscuring part of my solution through <em>IDE Magic</em>, such that when I run my Tomcat application I want to know how it's running. In fact, not only do I want to know <em>how</em> it runs, but I want the steps to run the application to be automated so I don't have to think about it. I know Eclipse can do this natively, but because I'm not looking to run Tomcat on my machine, it adds some challenges.</p>
<p>Here's what I did.</p>
<h2>Solution</h2>
<p>The solution is a simple one, but it works consistently. Plus, we'll even integrate it with Eclipse so people that don't like leaving their IDE can continue to code in in their comfort zone.</p>
<p>I am assuming that you...</p>
<ul>
<li>...are running Windows</li>
<li>...have a Maven web app project</li>
<li>...have setup Boot2Docker</li>
<li>...have a linux-flavoured shell (like Git Bash)</li>
</ul>
<p>Maven gives us a standard structure for our project. More specifically, it packages everything up into the <code>/target</code> directory so that we can map the volume to our docker image.</p>
<p>Now, let's make this run every time.</p>
<h3>The Start Script</h3>
<p>The first script I created just packages things up, makes sure boot2docker is running, and runs docker.</p>
<p>Being that I run the script from the project root, it looks like this:</p>
<p>{% codeblock lang:bash %}
#!/bin/bash</p>
<h1>package the WAR file</h1>
<p>mvn package</p>
<h1>Make sure docker instance is running</h1>
<p>boot2docker up</p>
<h1>Run the application</h1>
<p>docker run --rm -p 8080:8080 -v //./target/mywebapp:/usr/local/tomcat/webapps/mywebapp tomcat:6.0
{% endcodeblock %}</p>
<h3>The Stop Script</h3>
<p>Thanks to the power of Bingoogle, I was able to find <a href="https://coderwall.com/p/ewk0mq/stop-remove-all-docker-containers">this</a>.</p>
<p>{% codeblock lang:bash %}
docker stop $(docker ps -a -q)
{% endcodeblock %}</p>
<p>And there are my scripts to start and stop my application. The main reason for creating these is to make sure that anyone pulling down the solution can be productive. Even those that like staying inside of Eclipse all the time.</p>
<h3>Integrating with Eclipse</h3>
<p>Because we have these scripts, we can setup a couple of "External Tools" to start and stop at the push of a button.</p>
<p><img src="http://blog.davidwesst.com/2015/08/Running-Tomcat-Apps-on-Docker-through-Eclipse/1-externaltoolsbutton.png"></p>
<p>To set it up, click the button or the drop down and select "External Tools Configuration", then setup a couple of programs where you call sh.exe (provided with Git Bash) and our new scripts as the arguments.</p>
<p><img src="http://blog.davidwesst.com/2015/08/Running-Tomcat-Apps-on-Docker-through-Eclipse/2-configwindow.png"></p>
<p>Now everybody can start and stop at their leisure. Plus, if we need to add more complexity to starting and stopping, we can just extend the scripts.</p>
<h3>Alternatively...Make a Dockerfile</h3>
<p>That being said, we could also customize our docker image to include files right on the image rather than mapping volumes. Although this doesn't add any value to this example, it might later on if we want to start customizing our Tomcat server to include multiple files or other libraries that our application will need.</p>
<p><strong>FUN FACT:</strong> Copying the files over to the image means that you can't do any debugging on them in your environment right away, as opposed to if you were to map the files locally. Not a big deal in some cases, but I like to keep all the doors open for debugging.</p>
<p>Here's an example, but you can get the full scoop on dockerfiles <a href="https://docs.docker.com/articles/dockerfile_best-practices/">here</a>:</p>
<p>{% codeblock lang:bash %}
FROM tomcat:6.0
MAINTAINER David Wesst <a href="mailto:questions@davidwesst.com">questions@davidwesst.com</a></p>
<h1>add our WAR files</h1>
<p>ADD target/*.war /usr/local/tomcat/webapps/
{% endcodeblock %}</p>
<p>Then we need to update our <code>start-docker.sh</code> file from above to build the new image so we can run it.</p>
<p>{% codeblock lang:bash %}
#!/bin/bash</p>
<h1>package the WAR file</h1>
<p>mvn package</p>
<h1>Make sure docker instance is running</h1>
<p>boot2docker up</p>
<h1>Build a new docker image</h1>
<p>docker build -t davidwesst/tomcatsample:dev .</p>
<h1>Run the application</h1>
<p>docker run --rm -p 8080:8080 umanitoba/tomcatsample:dev
{% endcodeblock %}</p>
<h3>The Point</h3>
<p>This is a pretty straightforward example on how to use docker, and how to tie it into any processes or IDEs that you may have. I know that <a href="http://www.eclipse.org/community/eclipse_newsletter/2015/june/article3.php">Eclipse Mars has functionality for docker</a>, but sometimes we don't get to use the shiny new toy and need to stick with the old realiable ones. This solution works with Eclipse Luna, and below from what I can gather, so people that are stuck using older IDEs can still enjoy Docker.</p>
<p>...but you should really get comfortable with the command line and <a href="http://blog.davidwesst.com/talks/">Learn to be IDE Free (Shameless Self Promotion)</a>.</p>
<p>--
Thanks for Playing
~ DW</p>
</div></article><footer><a href="/blog">Back to Post Listing</a></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"running-tomcat-apps-on-docker-through-eclipse","htmlContent":"\u003cp\u003eIf you didn't already know, \u003ca href=\"https://www.docker.com\"\u003eDocker\u003c/a\u003e is pretty cool. Not sure what it is? My fellow Western Dev \u003ca href=\"http://www.westerndevs.com/docker-is-coming-whether-you-like-it-or-not/\"\u003eKyle Baley\u003c/a\u003e explains it really well and provides some great cases about why Docker is fantastic.\u003c/p\u003e\n\u003cp\u003eThis post is an example of Docker being fantastic and should be considered a warm-up to Docker.\u003c/p\u003e\n\u003c!--more--\u003e\n\u003cp\u003eAlthough I'm talking Tomcat and Eclipse, this idea can be used with pretty much any combination of technologies available through Docker and your development environment of choice.\u003c/p\u003e\n\u003ch2\u003eContext\u003c/h2\u003e\n\u003cp\u003eWhen I dive into the code, I don't want to have to worry about running some version of Tomcat on my development machine.\u003c/p\u003e\n\u003cp\u003eDocker can solve that.\u003c/p\u003e\n\u003cp\u003eI also don't like obscuring part of my solution through \u003cem\u003eIDE Magic\u003c/em\u003e, such that when I run my Tomcat application I want to know how it's running. In fact, not only do I want to know \u003cem\u003ehow\u003c/em\u003e it runs, but I want the steps to run the application to be automated so I don't have to think about it. I know Eclipse can do this natively, but because I'm not looking to run Tomcat on my machine, it adds some challenges.\u003c/p\u003e\n\u003cp\u003eHere's what I did.\u003c/p\u003e\n\u003ch2\u003eSolution\u003c/h2\u003e\n\u003cp\u003eThe solution is a simple one, but it works consistently. Plus, we'll even integrate it with Eclipse so people that don't like leaving their IDE can continue to code in in their comfort zone.\u003c/p\u003e\n\u003cp\u003eI am assuming that you...\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e...are running Windows\u003c/li\u003e\n\u003cli\u003e...have a Maven web app project\u003c/li\u003e\n\u003cli\u003e...have setup Boot2Docker\u003c/li\u003e\n\u003cli\u003e...have a linux-flavoured shell (like Git Bash)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eMaven gives us a standard structure for our project. More specifically, it packages everything up into the \u003ccode\u003e/target\u003c/code\u003e directory so that we can map the volume to our docker image.\u003c/p\u003e\n\u003cp\u003eNow, let's make this run every time.\u003c/p\u003e\n\u003ch3\u003eThe Start Script\u003c/h3\u003e\n\u003cp\u003eThe first script I created just packages things up, makes sure boot2docker is running, and runs docker.\u003c/p\u003e\n\u003cp\u003eBeing that I run the script from the project root, it looks like this:\u003c/p\u003e\n\u003cp\u003e{% codeblock lang:bash %}\n#!/bin/bash\u003c/p\u003e\n\u003ch1\u003epackage the WAR file\u003c/h1\u003e\n\u003cp\u003emvn package\u003c/p\u003e\n\u003ch1\u003eMake sure docker instance is running\u003c/h1\u003e\n\u003cp\u003eboot2docker up\u003c/p\u003e\n\u003ch1\u003eRun the application\u003c/h1\u003e\n\u003cp\u003edocker run --rm -p 8080:8080 -v //./target/mywebapp:/usr/local/tomcat/webapps/mywebapp tomcat:6.0\n{% endcodeblock %}\u003c/p\u003e\n\u003ch3\u003eThe Stop Script\u003c/h3\u003e\n\u003cp\u003eThanks to the power of Bingoogle, I was able to find \u003ca href=\"https://coderwall.com/p/ewk0mq/stop-remove-all-docker-containers\"\u003ethis\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e{% codeblock lang:bash %}\ndocker stop $(docker ps -a -q)\n{% endcodeblock %}\u003c/p\u003e\n\u003cp\u003eAnd there are my scripts to start and stop my application. The main reason for creating these is to make sure that anyone pulling down the solution can be productive. Even those that like staying inside of Eclipse all the time.\u003c/p\u003e\n\u003ch3\u003eIntegrating with Eclipse\u003c/h3\u003e\n\u003cp\u003eBecause we have these scripts, we can setup a couple of \"External Tools\" to start and stop at the push of a button.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"http://blog.davidwesst.com/2015/08/Running-Tomcat-Apps-on-Docker-through-Eclipse/1-externaltoolsbutton.png\"\u003e\u003c/p\u003e\n\u003cp\u003eTo set it up, click the button or the drop down and select \"External Tools Configuration\", then setup a couple of programs where you call sh.exe (provided with Git Bash) and our new scripts as the arguments.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"http://blog.davidwesst.com/2015/08/Running-Tomcat-Apps-on-Docker-through-Eclipse/2-configwindow.png\"\u003e\u003c/p\u003e\n\u003cp\u003eNow everybody can start and stop at their leisure. Plus, if we need to add more complexity to starting and stopping, we can just extend the scripts.\u003c/p\u003e\n\u003ch3\u003eAlternatively...Make a Dockerfile\u003c/h3\u003e\n\u003cp\u003eThat being said, we could also customize our docker image to include files right on the image rather than mapping volumes. Although this doesn't add any value to this example, it might later on if we want to start customizing our Tomcat server to include multiple files or other libraries that our application will need.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eFUN FACT:\u003c/strong\u003e Copying the files over to the image means that you can't do any debugging on them in your environment right away, as opposed to if you were to map the files locally. Not a big deal in some cases, but I like to keep all the doors open for debugging.\u003c/p\u003e\n\u003cp\u003eHere's an example, but you can get the full scoop on dockerfiles \u003ca href=\"https://docs.docker.com/articles/dockerfile_best-practices/\"\u003ehere\u003c/a\u003e:\u003c/p\u003e\n\u003cp\u003e{% codeblock lang:bash %}\nFROM tomcat:6.0\nMAINTAINER David Wesst \u003ca href=\"mailto:questions@davidwesst.com\"\u003equestions@davidwesst.com\u003c/a\u003e\u003c/p\u003e\n\u003ch1\u003eadd our WAR files\u003c/h1\u003e\n\u003cp\u003eADD target/*.war /usr/local/tomcat/webapps/\n{% endcodeblock %}\u003c/p\u003e\n\u003cp\u003eThen we need to update our \u003ccode\u003estart-docker.sh\u003c/code\u003e file from above to build the new image so we can run it.\u003c/p\u003e\n\u003cp\u003e{% codeblock lang:bash %}\n#!/bin/bash\u003c/p\u003e\n\u003ch1\u003epackage the WAR file\u003c/h1\u003e\n\u003cp\u003emvn package\u003c/p\u003e\n\u003ch1\u003eMake sure docker instance is running\u003c/h1\u003e\n\u003cp\u003eboot2docker up\u003c/p\u003e\n\u003ch1\u003eBuild a new docker image\u003c/h1\u003e\n\u003cp\u003edocker build -t davidwesst/tomcatsample:dev .\u003c/p\u003e\n\u003ch1\u003eRun the application\u003c/h1\u003e\n\u003cp\u003edocker run --rm -p 8080:8080 umanitoba/tomcatsample:dev\n{% endcodeblock %}\u003c/p\u003e\n\u003ch3\u003eThe Point\u003c/h3\u003e\n\u003cp\u003eThis is a pretty straightforward example on how to use docker, and how to tie it into any processes or IDEs that you may have. I know that \u003ca href=\"http://www.eclipse.org/community/eclipse_newsletter/2015/june/article3.php\"\u003eEclipse Mars has functionality for docker\u003c/a\u003e, but sometimes we don't get to use the shiny new toy and need to stick with the old realiable ones. This solution works with Eclipse Luna, and below from what I can gather, so people that are stuck using older IDEs can still enjoy Docker.\u003c/p\u003e\n\u003cp\u003e...but you should really get comfortable with the command line and \u003ca href=\"http://blog.davidwesst.com/talks/\"\u003eLearn to be IDE Free (Shameless Self Promotion)\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003e--\nThanks for Playing\n~ DW\u003c/p\u003e\n","layout":"post","title":"Running Tomcat Apps on Docker through Eclipse","date":"Fri Aug 07 2015 07:55:40 GMT-0500 (Central Daylight Time)","categories":null,"comments":true,"authorId":"david_wesst","originalurl":"http://blog.davidwesst.com/2015/08/Running-Tomcat-Apps-on-Docker-through-Eclipse/"}},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"running-tomcat-apps-on-docker-through-eclipse"},"buildId":"-9wn_hi6_-Q32OgH9YOcv","assetPrefix":"https://www.davidwesst.com","runtimeConfig":{},"nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="https://www.davidwesst.com/_next/static/runtime/polyfills-10c88b4b028d13fe33de.js"></script><script async="" data-next-page="/_app" src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/_app.js"></script><script async="" data-next-page="/blog/[id]" src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/blog/%5Bid%5D.js"></script><script src="https://www.davidwesst.com/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="https://www.davidwesst.com/_next/static/chunks/framework.e84fa698c7ee940652bd.js" async=""></script><script src="https://www.davidwesst.com/_next/static/chunks/commons.7c101d7f1672b68d7c1c.js" async=""></script><script src="https://www.davidwesst.com/_next/static/runtime/main-98aa3916935decc0cde3.js" async=""></script><script src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/_buildManifest.js" async=""></script><script src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/_ssgManifest.js" async=""></script></body></html>