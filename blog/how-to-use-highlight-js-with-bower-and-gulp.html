<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/_app.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/blog/%5Bid%5D.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/chunks/framework.e84fa698c7ee940652bd.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/chunks/commons.7c101d7f1672b68d7c1c.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/runtime/main-98aa3916935decc0cde3.js" as="script"/></head><body><div id="__next"><h1>How to Use Highlight.Js with Bower and Gulp</h1><article><div>how-to-use-highlight-js-with-bower-and-gulp</div><div>Mon Aug 29 2016 05:07:11 GMT-0500 (Central Daylight Time)</div><div><p>One of the challenges I faced when getting my new blog theme up and running was getting <a href="https://highlightjs.org">highlight.js</a> working as I wanted it to. The library has support for a riduculous number of languages, and provides theming capabilities, so it was the clear choice when it came to syntax highlighting for the web. The challenge is that tt's not just adding simple script tag and you're done with it. They seem to expect you to know what you're doing when consuming the library. </p>
<p>Remember: this is a <em>good thing</em>. </p>
<p>If you're only include code snippets for HTML and JavaScript, why would you want to bring down the stylesheets for D, Erlang, and ActionScript too? Same goes for the themes too. You're likely going to pick a single theme and go with it, and not need all 77 they include. Because of the size of highlight.js, bringing it all down to the client would have a significant impact on your site's performance.</p>
<p>Lucky for us, the folks in charge of highlight.js have given us all the tools we need to make using the library in our application nice and performant. In my case, I use <a href="https://bower.io">Bower</a> as my package manager and <a href="http://gulpjs.com">Gulp</a> as my build system, which worked well once I figured out what I was doing. Let me walk you though it.</p>
<h2>Installing Highlight.js with Bower</h2>
<p>To start, you'll need to add highlight.js to your project using Bower.</p>
<pre><code class="language-bash">bower install --save highligh.js.origin
</code></pre>
<p>Generally speaking, after you install a package from Bower you have a ready-to-use JavaScript library. With highlight.js, this is not the case. Rather, you are left with source code ready to be built as you need it. To do that, we are going to use Gulp.</p>
<h2>Building Highlight.js with Gulp</h2>
<p>The hard work has already been done by the highlight.js team, as they have already included a lovely build tool for us to use. You can read about the details <a href="http://highlightjs.readthedocs.io/en/latest/building-testing.html">here in the building and testing documentation</a>. </p>
<p>There are two parts to "building" highlight.js: the JavaScript and the stylesheets. We'll be creating a task for each of them.</p>
<h3>Building highlight.js JavaScript</h3>
<p>Let's start with the JavaScript component.</p>
<p>If you read the <a href="http://highlightjs.readthedocs.io/en/latest/building-testing.html">docs</a> earlier, you know that there is a NodeJS script in the <code>tools</code> directory that will do all the heavy lifting. All we need to do in our Gulp task is use that script.</p>
<p>Here's my Gulp task:</p>
<pre><code class="language-javascript">gulp.task('process-highlightjs-script', function(callback) {
    let command = 'cd bower_components/highlight.js.origin'
                    + ' &#x26;&#x26; npm install' 
                    + ' &#x26;&#x26; node tools/build :common';
    exec(command, (err, stdout, stderr)=> {
        console.log(stderr);
        console.log(stdout);

        callback(err);
    });

    return;
});
</code></pre>
<p>It looks a little strange for a gulp task, but all I'm doing is executing a shell command using the <a href="https://nodejs.org/api/child_process.html#child_process_child_process_exec_command_options_callback"><code>exec</code></a> in NodeJS to spawn a child process. The important part is in the <code>command</code> variable. Let's walk through it.</p>
<pre><code class="language-bash">cd bower_components/highlight.js.origin
</code></pre>
<p>First, I'm moving into the root directory of the highligh.js.origin package we previously installed using Bower.</p>
<pre><code class="language-bash">npm install
</code></pre>
<p>Then, I'm installing the dependencies that are needed by the provided build tool.</p>
<pre><code class="language-bash">node tools/build :common
</code></pre>
<p>Finally, I'm running the build command as specified in the documentation. This part should be changed to make sure it includes the languages you want to display in your application. Details are in their <a href="http://highlightjs.readthedocs.io/en/latest/building-testing.html">documentation</a>.</p>
<p>The rest is just outputting the standard out and standard error streams to the console, and calling the Gulp callback to make sure we come back to our original process, as per the <a href="https://github.com/gulpjs/gulp/blob/master/docs/API.md#async-task-support">Gulp documentation</a>. </p>
<p>If everything is done correctly, you should have a new <code>build</code> folder in the <code>highlight.js.origin</code> folder that contains your newly build library.</p>
<h2>Building Highlight.js Themes for SASS</h2>
<p>I suppose this part is optional, but it shouldn't be.</p>
<p>To make optimize your site, you should be minimizing the number of requests that the client browser needs to make to get all the required resources for your application. For styling, that involves concatenanting all of your styles and style libraries into a single file.</p>
<p>To do this, I use <a href="http://sass-lang.com">SASS</a> or, more specifically, <a href="https://www.npmjs.com/package/gulp-sass">gulp-sass</a> to build all of my stylesheets and combine them into a single CSS file as described by the <a href="http://sass-lang.com/guide#topic-5">SASS documentation</a>. I'm going to assume that you're doing the same, or at least something similar in your application that will be using highlight.js.</p>
<p>Because SASS only handles combining other <code>scss</code> files, I copy the theme stylesheet into a newly named <code>scss</code> file. Here's my gulp task for that:</p>
<pre><code class="language-javascript">gulp.task('process-highlightjs-style', function() {
    let stylesheets = [
        './bower_components/highlight.js.origin/src/styles/atom-one-dark.css'
    ];

    return gulp.src(stylesheets)
            .pipe(rename('highlight.js.scss'))
            .pipe(gulp.dest('./bower_components/highlight.js.origin/scss'));
});
</code></pre>
<p>Then in my main stylesheet, I include:</p>
<pre><code class="language-scss">@import '../../bower_components/highlight.js.origin/scss/highlight.js';
</code></pre>
<p>This will bring in the <code>highlight.js.scss</code> file when I build my styles using <code>gulp-sass</code> in my application stylesheet build task.</p>
<p>And now highlight.js ready to Use in our application.</p>
<figure class="image">
    ![Highlight.js in Action](http://i.imgur.com/1cUniu9.png)
    <figcaption>Highlight.js in Action</figcaption>
</figure>
<h4>Caveat About Using Highlight.js with Markdown</h4>
<p>My post assumes that for any blocks of text where you want syntax highlighting you're comfortable using the default <a href="https://highlightjs.org/usage/">highlight.js usage</a> behaviour of wrapping the code with <code>&#x3C;pre>&#x3C;code></code> elements.</p>
<p>Although I blog using Markdown, at the time of this writing I still wrap my text with these elements, unlike <a href="https://help.github.com/articles/creating-and-highlighting-code-blocks/">GitHub flavoured markdown</a> that lets define the language using regular Markdown syntax.</p>
<p>The reason for this, is that my blog engine renders the Markdown syntax with a bunch of extra HTML woven throughout the code to display it without the need for a library like highlight.js. </p>
<p>It might not be a big deal for you or your project, but I thought it was something you should be aware of when if you're planning on using highlight.js in your application.</p>
</div></article><footer><a href="/blog">Back to Post Listing</a></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"how-to-use-highlight-js-with-bower-and-gulp","htmlContent":"\u003cp\u003eOne of the challenges I faced when getting my new blog theme up and running was getting \u003ca href=\"https://highlightjs.org\"\u003ehighlight.js\u003c/a\u003e working as I wanted it to. The library has support for a riduculous number of languages, and provides theming capabilities, so it was the clear choice when it came to syntax highlighting for the web. The challenge is that tt's not just adding simple script tag and you're done with it. They seem to expect you to know what you're doing when consuming the library. \u003c/p\u003e\n\u003cp\u003eRemember: this is a \u003cem\u003egood thing\u003c/em\u003e. \u003c/p\u003e\n\u003cp\u003eIf you're only include code snippets for HTML and JavaScript, why would you want to bring down the stylesheets for D, Erlang, and ActionScript too? Same goes for the themes too. You're likely going to pick a single theme and go with it, and not need all 77 they include. Because of the size of highlight.js, bringing it all down to the client would have a significant impact on your site's performance.\u003c/p\u003e\n\u003cp\u003eLucky for us, the folks in charge of highlight.js have given us all the tools we need to make using the library in our application nice and performant. In my case, I use \u003ca href=\"https://bower.io\"\u003eBower\u003c/a\u003e as my package manager and \u003ca href=\"http://gulpjs.com\"\u003eGulp\u003c/a\u003e as my build system, which worked well once I figured out what I was doing. Let me walk you though it.\u003c/p\u003e\n\u003ch2\u003eInstalling Highlight.js with Bower\u003c/h2\u003e\n\u003cp\u003eTo start, you'll need to add highlight.js to your project using Bower.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003ebower install --save highligh.js.origin\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eGenerally speaking, after you install a package from Bower you have a ready-to-use JavaScript library. With highlight.js, this is not the case. Rather, you are left with source code ready to be built as you need it. To do that, we are going to use Gulp.\u003c/p\u003e\n\u003ch2\u003eBuilding Highlight.js with Gulp\u003c/h2\u003e\n\u003cp\u003eThe hard work has already been done by the highlight.js team, as they have already included a lovely build tool for us to use. You can read about the details \u003ca href=\"http://highlightjs.readthedocs.io/en/latest/building-testing.html\"\u003ehere in the building and testing documentation\u003c/a\u003e. \u003c/p\u003e\n\u003cp\u003eThere are two parts to \"building\" highlight.js: the JavaScript and the stylesheets. We'll be creating a task for each of them.\u003c/p\u003e\n\u003ch3\u003eBuilding highlight.js JavaScript\u003c/h3\u003e\n\u003cp\u003eLet's start with the JavaScript component.\u003c/p\u003e\n\u003cp\u003eIf you read the \u003ca href=\"http://highlightjs.readthedocs.io/en/latest/building-testing.html\"\u003edocs\u003c/a\u003e earlier, you know that there is a NodeJS script in the \u003ccode\u003etools\u003c/code\u003e directory that will do all the heavy lifting. All we need to do in our Gulp task is use that script.\u003c/p\u003e\n\u003cp\u003eHere's my Gulp task:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003egulp.task('process-highlightjs-script', function(callback) {\n    let command = 'cd bower_components/highlight.js.origin'\n                    + ' \u0026#x26;\u0026#x26; npm install' \n                    + ' \u0026#x26;\u0026#x26; node tools/build :common';\n    exec(command, (err, stdout, stderr)=\u003e {\n        console.log(stderr);\n        console.log(stdout);\n\n        callback(err);\n    });\n\n    return;\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIt looks a little strange for a gulp task, but all I'm doing is executing a shell command using the \u003ca href=\"https://nodejs.org/api/child_process.html#child_process_child_process_exec_command_options_callback\"\u003e\u003ccode\u003eexec\u003c/code\u003e\u003c/a\u003e in NodeJS to spawn a child process. The important part is in the \u003ccode\u003ecommand\u003c/code\u003e variable. Let's walk through it.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecd bower_components/highlight.js.origin\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFirst, I'm moving into the root directory of the highligh.js.origin package we previously installed using Bower.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003enpm install\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen, I'm installing the dependencies that are needed by the provided build tool.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003enode tools/build :common\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFinally, I'm running the build command as specified in the documentation. This part should be changed to make sure it includes the languages you want to display in your application. Details are in their \u003ca href=\"http://highlightjs.readthedocs.io/en/latest/building-testing.html\"\u003edocumentation\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe rest is just outputting the standard out and standard error streams to the console, and calling the Gulp callback to make sure we come back to our original process, as per the \u003ca href=\"https://github.com/gulpjs/gulp/blob/master/docs/API.md#async-task-support\"\u003eGulp documentation\u003c/a\u003e. \u003c/p\u003e\n\u003cp\u003eIf everything is done correctly, you should have a new \u003ccode\u003ebuild\u003c/code\u003e folder in the \u003ccode\u003ehighlight.js.origin\u003c/code\u003e folder that contains your newly build library.\u003c/p\u003e\n\u003ch2\u003eBuilding Highlight.js Themes for SASS\u003c/h2\u003e\n\u003cp\u003eI suppose this part is optional, but it shouldn't be.\u003c/p\u003e\n\u003cp\u003eTo make optimize your site, you should be minimizing the number of requests that the client browser needs to make to get all the required resources for your application. For styling, that involves concatenanting all of your styles and style libraries into a single file.\u003c/p\u003e\n\u003cp\u003eTo do this, I use \u003ca href=\"http://sass-lang.com\"\u003eSASS\u003c/a\u003e or, more specifically, \u003ca href=\"https://www.npmjs.com/package/gulp-sass\"\u003egulp-sass\u003c/a\u003e to build all of my stylesheets and combine them into a single CSS file as described by the \u003ca href=\"http://sass-lang.com/guide#topic-5\"\u003eSASS documentation\u003c/a\u003e. I'm going to assume that you're doing the same, or at least something similar in your application that will be using highlight.js.\u003c/p\u003e\n\u003cp\u003eBecause SASS only handles combining other \u003ccode\u003escss\u003c/code\u003e files, I copy the theme stylesheet into a newly named \u003ccode\u003escss\u003c/code\u003e file. Here's my gulp task for that:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003egulp.task('process-highlightjs-style', function() {\n    let stylesheets = [\n        './bower_components/highlight.js.origin/src/styles/atom-one-dark.css'\n    ];\n\n    return gulp.src(stylesheets)\n            .pipe(rename('highlight.js.scss'))\n            .pipe(gulp.dest('./bower_components/highlight.js.origin/scss'));\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen in my main stylesheet, I include:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-scss\"\u003e@import '../../bower_components/highlight.js.origin/scss/highlight.js';\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis will bring in the \u003ccode\u003ehighlight.js.scss\u003c/code\u003e file when I build my styles using \u003ccode\u003egulp-sass\u003c/code\u003e in my application stylesheet build task.\u003c/p\u003e\n\u003cp\u003eAnd now highlight.js ready to Use in our application.\u003c/p\u003e\n\u003cfigure class=\"image\"\u003e\n    ![Highlight.js in Action](http://i.imgur.com/1cUniu9.png)\n    \u003cfigcaption\u003eHighlight.js in Action\u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003ch4\u003eCaveat About Using Highlight.js with Markdown\u003c/h4\u003e\n\u003cp\u003eMy post assumes that for any blocks of text where you want syntax highlighting you're comfortable using the default \u003ca href=\"https://highlightjs.org/usage/\"\u003ehighlight.js usage\u003c/a\u003e behaviour of wrapping the code with \u003ccode\u003e\u0026#x3C;pre\u003e\u0026#x3C;code\u003e\u003c/code\u003e elements.\u003c/p\u003e\n\u003cp\u003eAlthough I blog using Markdown, at the time of this writing I still wrap my text with these elements, unlike \u003ca href=\"https://help.github.com/articles/creating-and-highlighting-code-blocks/\"\u003eGitHub flavoured markdown\u003c/a\u003e that lets define the language using regular Markdown syntax.\u003c/p\u003e\n\u003cp\u003eThe reason for this, is that my blog engine renders the Markdown syntax with a bunch of extra HTML woven throughout the code to display it without the need for a library like highlight.js. \u003c/p\u003e\n\u003cp\u003eIt might not be a big deal for you or your project, but I thought it was something you should be aware of when if you're planning on using highlight.js in your application.\u003c/p\u003e\n","layout":"post","title":"How to Use Highlight.Js with Bower and Gulp","date":"Mon Aug 29 2016 05:07:11 GMT-0500 (Central Daylight Time)","tags":["gulp","bower","highlight.js","javascript"],"excerpt":"One of the best libraries I've seen for syntax highlighting on the web is highlight.js, IMHO. The catch to using the library is that it takes a bit more effort to setup than just adding a script tag and being done with it. In this post, I'll walk you through the steps I took to get this up and running with Bower and Gulp.","authorId":"david_wesst","originalurl":"https://blog.davidwesst.com/2016/08/How-to-Use-HighlightJs-with-Bower-and-Gulp/"}},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"how-to-use-highlight-js-with-bower-and-gulp"},"buildId":"-9wn_hi6_-Q32OgH9YOcv","assetPrefix":"https://www.davidwesst.com","runtimeConfig":{},"nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="https://www.davidwesst.com/_next/static/runtime/polyfills-10c88b4b028d13fe33de.js"></script><script async="" data-next-page="/_app" src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/_app.js"></script><script async="" data-next-page="/blog/[id]" src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/blog/%5Bid%5D.js"></script><script src="https://www.davidwesst.com/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="https://www.davidwesst.com/_next/static/chunks/framework.e84fa698c7ee940652bd.js" async=""></script><script src="https://www.davidwesst.com/_next/static/chunks/commons.7c101d7f1672b68d7c1c.js" async=""></script><script src="https://www.davidwesst.com/_next/static/runtime/main-98aa3916935decc0cde3.js" async=""></script><script src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/_buildManifest.js" async=""></script><script src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/_ssgManifest.js" async=""></script></body></html>