<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/_app.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/blog/%5Bid%5D.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/chunks/framework.e84fa698c7ee940652bd.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/chunks/commons.7c101d7f1672b68d7c1c.js" as="script"/><link rel="preload" href="https://www.davidwesst.com/_next/static/runtime/main-98aa3916935decc0cde3.js" as="script"/></head><body><div id="__next"><h1>Capturing HTTPS Traffic in Java with Eclipse and Fiddler</h1><article><div>capture-https-traffic-in-java-with-eclipse-and-fiddler</div><div>Wed Oct 07 2015 04:41:35 GMT-0500 (Central Daylight Time)</div><div><p>I've been struggling with a JSON parsing error where my application is using the <a href="https://spring.io/guides/gs/consuming-rest/">Spring</a> to send and receive messages from a RESTful Web Service. It's pretty straight forward: I've annotated my object properties to match up with the appropriate JSON keys, Spring takes my POJO and turns it into a JSON string sends the request along with the JSON as the body to the HTTPS endpoint, et voilà!  </p>
<!--more-->
<h2>The Problem</h2>
<p>The problem comes in when something goes wrong with the request/response. Because the Spring obfuscates the actual request/response content, debugging it means you need to take a look at the traffic being sent over the wire. Since we're using a good RESTful service, the connection is done through HTTPS, meaning it's encrypted with a certificate that we don't have.</p>
<p>On top of that, it appears that Fiddler doesn't automatically capture Java HTTP traffic automatically, so that's a thing too.</p>
<p>After some internet sleuthing, I put together a solution that I wanted to share with you all, and so that I don't forget how to do it myself.</p>
<h3>Setup</h3>
<ol>
<li>Downlaod and Install <a href="http://www.telerik.com/fiddler">Fiddler</a>. I used Fiddler4, because I'm awesome.</li>
<li>Run it and make sure it's capturing HTTP traffic</li>
<li>Open <em>Tools --> Fiddler Options --> Connections Tab</em> and take note of the "Fiddler listens on port" value. It's likely 8888, but best to be sure.</li>
<li>In the same window select <em>HTTPS Tab</em> and make sure sure that the following options <strong>are checked</strong>:<ul>
<li>Capture HTTPS CONNECTS</li>
<li>Decrypt HTTPS traffic (...from all processes)</li>
</ul></li>
</ol>
<p><img src="http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/certificate-warning.png" alt="http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/certificate-warning.png"></p>
<ol start="6">
<li>Read, and if you're alright with it, install the certificate.</li>
<li>On the HTTPS tab, click the <em>Export Root Certificate to Desktop</em> and click OK.</li>
</ol>
<p><img src="http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/fiddler-options.png" alt="http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/fiddler-options.png"></p>
<h3>Generating a Keystore</h3>
<ol>
<li>Open a command line terminal as an administrator</li>
<li>Run the keytool for the JDK your application is using:</li>
</ol>
<p>{% codeblock lang:powershell %}</p>
<p>&#x3C;JDK_Home>\bin\keytool.exe -import -file C:\Users\<Username>\Desktop\FiddlerRoot.cer^
-keystore FiddlerKeystore -alias Fiddler</p>
<p>{% endcodeblock %}</p>
<ol start="3">
<li>Enter a password and remember it</li>
<li>Your keystore is created as a file named "FiddlerKeystore*. Take note of where it is located on your machine.</li>
</ol>
<h3>Configuring Eclipse</h3>
<p><strong>NOTE:</strong> You are not required to use Eclipse for this, but it seems to be the popular way of writing Java code.</p>
<ol>
<li>Open your project and go to <em>Run --> Run Configurations</em></li>
<li>Select the Run Configuration you want to use where you'll capture the HTTPS traffic.</li>
<li>Select the <em>Arguments</em> tab</li>
<li>Add the following to the <em>VMargs</em> textbox:</li>
</ol>
<p>{% codeblock lang:java %}</p>
<p>-DproxySet=true
-DproxyHost=127.0.0.1
-DproxyPort=8888
-Djavax.net.ssl.trustStore="path\to\keystore\FiddlerKeystore"
-Djavax.net.ssl.trustStorePassword=yourpassword</p>
<p>{% endcodeblock %}</p>
<ol start="5">
<li>Click the <em>Apply</em> button</li>
<li>Click the <em>Run</em> button to try it out</li>
</ol>
<p><img src="http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/eclipse-settings.png" alt="http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/eclipse-settings.png"></p>
<p>Tada! You're done, and you should now be able to run your code and see the HTTP request and response, completely.</p>
<p><img src="http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/fiddler-success.png" alt="http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/fiddler-success.png"></p>
<h3>Alternative Solution --- Configuring Your Code</h3>
<p>Add the following lines to the application that you want to capture the HTTPS traffic.</p>
<p>{% codeblock lang:java %}</p>
<p>// for capturing HTTP traffic
System.setProperty("http.proxyHost", "127.0.0.1");
System.setProperty("http.proxyPort", "8888");
// for capturing HTTPS traffic
System.setProperty("https.proxyHost", "127.0.0.1");
System.setProperty("https.proxyPort", "8888");</p>
<p>{% endcodeblock %}</p>
<p>--
Thanks for playing. ~ DW</p>
<h6>References</h6>
<ol>
<li><a href="http://stackoverflow.com/questions/8549749/how-to-capture-https-with-fiddler-in-java">Stack Overflow - How to Capture HTTPS with Fiddler in Java</a></li>
<li><a href="http://codeketchup.blogspot.ca/2014/03/how-to-use-eclipse-with-fiddler-step-by.html">How to Use Eclipse with Fiddler</a></li>
</ol>
</div></article><footer><a href="/blog">Back to Post Listing</a></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"capture-https-traffic-in-java-with-eclipse-and-fiddler","htmlContent":"\u003cp\u003eI've been struggling with a JSON parsing error where my application is using the \u003ca href=\"https://spring.io/guides/gs/consuming-rest/\"\u003eSpring\u003c/a\u003e to send and receive messages from a RESTful Web Service. It's pretty straight forward: I've annotated my object properties to match up with the appropriate JSON keys, Spring takes my POJO and turns it into a JSON string sends the request along with the JSON as the body to the HTTPS endpoint, et voilà!  \u003c/p\u003e\n\u003c!--more--\u003e\n\u003ch2\u003eThe Problem\u003c/h2\u003e\n\u003cp\u003eThe problem comes in when something goes wrong with the request/response. Because the Spring obfuscates the actual request/response content, debugging it means you need to take a look at the traffic being sent over the wire. Since we're using a good RESTful service, the connection is done through HTTPS, meaning it's encrypted with a certificate that we don't have.\u003c/p\u003e\n\u003cp\u003eOn top of that, it appears that Fiddler doesn't automatically capture Java HTTP traffic automatically, so that's a thing too.\u003c/p\u003e\n\u003cp\u003eAfter some internet sleuthing, I put together a solution that I wanted to share with you all, and so that I don't forget how to do it myself.\u003c/p\u003e\n\u003ch3\u003eSetup\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eDownlaod and Install \u003ca href=\"http://www.telerik.com/fiddler\"\u003eFiddler\u003c/a\u003e. I used Fiddler4, because I'm awesome.\u003c/li\u003e\n\u003cli\u003eRun it and make sure it's capturing HTTP traffic\u003c/li\u003e\n\u003cli\u003eOpen \u003cem\u003eTools --\u003e Fiddler Options --\u003e Connections Tab\u003c/em\u003e and take note of the \"Fiddler listens on port\" value. It's likely 8888, but best to be sure.\u003c/li\u003e\n\u003cli\u003eIn the same window select \u003cem\u003eHTTPS Tab\u003c/em\u003e and make sure sure that the following options \u003cstrong\u003eare checked\u003c/strong\u003e:\u003cul\u003e\n\u003cli\u003eCapture HTTPS CONNECTS\u003c/li\u003e\n\u003cli\u003eDecrypt HTTPS traffic (...from all processes)\u003c/li\u003e\n\u003c/ul\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/certificate-warning.png\" alt=\"http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/certificate-warning.png\"\u003e\u003c/p\u003e\n\u003col start=\"6\"\u003e\n\u003cli\u003eRead, and if you're alright with it, install the certificate.\u003c/li\u003e\n\u003cli\u003eOn the HTTPS tab, click the \u003cem\u003eExport Root Certificate to Desktop\u003c/em\u003e and click OK.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/fiddler-options.png\" alt=\"http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/fiddler-options.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eGenerating a Keystore\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eOpen a command line terminal as an administrator\u003c/li\u003e\n\u003cli\u003eRun the keytool for the JDK your application is using:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e{% codeblock lang:powershell %}\u003c/p\u003e\n\u003cp\u003e\u0026#x3C;JDK_Home\u003e\\bin\\keytool.exe -import -file C:\\Users\\\u003cUsername\u003e\\Desktop\\FiddlerRoot.cer^\n-keystore FiddlerKeystore -alias Fiddler\u003c/p\u003e\n\u003cp\u003e{% endcodeblock %}\u003c/p\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003eEnter a password and remember it\u003c/li\u003e\n\u003cli\u003eYour keystore is created as a file named \"FiddlerKeystore*. Take note of where it is located on your machine.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003eConfiguring Eclipse\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eNOTE:\u003c/strong\u003e You are not required to use Eclipse for this, but it seems to be the popular way of writing Java code.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eOpen your project and go to \u003cem\u003eRun --\u003e Run Configurations\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003eSelect the Run Configuration you want to use where you'll capture the HTTPS traffic.\u003c/li\u003e\n\u003cli\u003eSelect the \u003cem\u003eArguments\u003c/em\u003e tab\u003c/li\u003e\n\u003cli\u003eAdd the following to the \u003cem\u003eVMargs\u003c/em\u003e textbox:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e{% codeblock lang:java %}\u003c/p\u003e\n\u003cp\u003e-DproxySet=true\n-DproxyHost=127.0.0.1\n-DproxyPort=8888\n-Djavax.net.ssl.trustStore=\"path\\to\\keystore\\FiddlerKeystore\"\n-Djavax.net.ssl.trustStorePassword=yourpassword\u003c/p\u003e\n\u003cp\u003e{% endcodeblock %}\u003c/p\u003e\n\u003col start=\"5\"\u003e\n\u003cli\u003eClick the \u003cem\u003eApply\u003c/em\u003e button\u003c/li\u003e\n\u003cli\u003eClick the \u003cem\u003eRun\u003c/em\u003e button to try it out\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/eclipse-settings.png\" alt=\"http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/eclipse-settings.png\"\u003e\u003c/p\u003e\n\u003cp\u003eTada! You're done, and you should now be able to run your code and see the HTTP request and response, completely.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/fiddler-success.png\" alt=\"http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/fiddler-success.png\"\u003e\u003c/p\u003e\n\u003ch3\u003eAlternative Solution --- Configuring Your Code\u003c/h3\u003e\n\u003cp\u003eAdd the following lines to the application that you want to capture the HTTPS traffic.\u003c/p\u003e\n\u003cp\u003e{% codeblock lang:java %}\u003c/p\u003e\n\u003cp\u003e// for capturing HTTP traffic\nSystem.setProperty(\"http.proxyHost\", \"127.0.0.1\");\nSystem.setProperty(\"http.proxyPort\", \"8888\");\n// for capturing HTTPS traffic\nSystem.setProperty(\"https.proxyHost\", \"127.0.0.1\");\nSystem.setProperty(\"https.proxyPort\", \"8888\");\u003c/p\u003e\n\u003cp\u003e{% endcodeblock %}\u003c/p\u003e\n\u003cp\u003e--\nThanks for playing. ~ DW\u003c/p\u003e\n\u003ch6\u003eReferences\u003c/h6\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"http://stackoverflow.com/questions/8549749/how-to-capture-https-with-fiddler-in-java\"\u003eStack Overflow - How to Capture HTTPS with Fiddler in Java\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://codeketchup.blogspot.ca/2014/03/how-to-use-eclipse-with-fiddler-step-by.html\"\u003eHow to Use Eclipse with Fiddler\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","layout":"post","title":"Capturing HTTPS Traffic in Java with Eclipse and Fiddler","date":"Wed Oct 07 2015 04:41:35 GMT-0500 (Central Daylight Time)","categories":null,"comments":true,"authorId":"david_wesst","originalurl":"http://blog.davidwesst.com/2015/10/Capturing-HTTPS-Traffic-in-Java-with-Eclipse-and-Fiddler/"}},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"capture-https-traffic-in-java-with-eclipse-and-fiddler"},"buildId":"-9wn_hi6_-Q32OgH9YOcv","assetPrefix":"https://www.davidwesst.com","runtimeConfig":{},"nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="https://www.davidwesst.com/_next/static/runtime/polyfills-10c88b4b028d13fe33de.js"></script><script async="" data-next-page="/_app" src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/_app.js"></script><script async="" data-next-page="/blog/[id]" src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/pages/blog/%5Bid%5D.js"></script><script src="https://www.davidwesst.com/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="https://www.davidwesst.com/_next/static/chunks/framework.e84fa698c7ee940652bd.js" async=""></script><script src="https://www.davidwesst.com/_next/static/chunks/commons.7c101d7f1672b68d7c1c.js" async=""></script><script src="https://www.davidwesst.com/_next/static/runtime/main-98aa3916935decc0cde3.js" async=""></script><script src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/_buildManifest.js" async=""></script><script src="https://www.davidwesst.com/_next/static/-9wn_hi6_-Q32OgH9YOcv/_ssgManifest.js" async=""></script></body></html>